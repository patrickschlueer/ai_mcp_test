<div class="card">
  <div class="card-header">
    <h2>Users ({{ filteredUsers.length }})</h2>
    <button class="btn btn-refresh" (click)="onRefresh()">
      🔄 Refresh
    </button>
  </div>

  <div class="search-section">
    <div class="search-input-container">
      <input 
        type="text" 
        class="search-input"
        placeholder="Search users by name, email or role..."
        [(ngModel)]="searchTerm"
        (input)="onSearchChange($event)"
        (keydown.escape)="clearSearch()"
        #searchInput
        aria-label="Search users"
        role="searchbox"
        aria-describedby="search-help">
      <button 
        class="btn btn-clear"
        *ngIf="searchTerm"
        (click)="clearSearch()"
        title="Clear search"
        aria-label="Clear search">
        ✕
      </button>
      <span class="search-icon" *ngIf="!searchTerm">🔍</span>
    </div>
    <div id="search-help" class="search-help" *ngIf="searchTerm">
      Showing {{ filteredUsers.length }} of {{ users.length }} users
    </div>
  </div>

  <div class="loading" *ngIf="loading">Loading users...</div>

  <div class="no-data" *ngIf="!loading && users.length === 0">
    No users found. Create one above!
  </div>

  <div class="no-results" *ngIf="!loading && users.length > 0 && filteredUsers.length === 0">
    <div class="no-results-icon">🔍</div>
    <h3>No users match your search</h3>
    <p>Try adjusting your search terms or <button class="btn-link" (click)="clearSearch()">clear the filter</button></p>
  </div>

  <table *ngIf="!loading && filteredUsers.length > 0">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Role</th>
        <th>Created</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <app-user-table-row 
        *ngFor="let user of filteredUsers"
        [user]="user"
        [searchTerm]="searchTerm"
        (edit)="onEdit($event)"
        (delete)="onDelete($event)">
      </app-user-table-row>
    </tbody>
  </table>
</div>