<div class="card">
  <div class="card-header">
    <div class="header-left">
      <h2>Users ({{ (filteredUsers$ | async)?.length || 0 }})</h2>
    </div>
    <div class="header-right">
      <div class="search-container">
        <input 
          type="text" 
          class="search-input"
          placeholder="Search users..."
          [formControl]="searchControl"
          aria-label="Search users by name, email or role">
        <span class="search-icon">🔍</span>
        <button 
          *ngIf="searchControl.value" 
          class="clear-search-btn"
          (click)="clearSearch()"
          aria-label="Clear search">
          ✕
        </button>
      </div>
      <button class="btn btn-refresh" (click)="onRefresh()">
        🔄 Refresh
      </button>
    </div>
  </div>

  <div class="loading" *ngIf="loading">Loading users...</div>

  <div class="no-data" *ngIf="!loading && (filteredUsers$ | async)?.length === 0 && !searchControl.value">
    No users found. Create one above!
  </div>

  <div class="no-search-results" *ngIf="!loading && (filteredUsers$ | async)?.length === 0 && searchControl.value">
    No users found matching "{{ searchControl.value }}". 
    <button class="link-btn" (click)="clearSearch()">Clear search</button>
  </div>

  <table *ngIf="!loading && (filteredUsers$ | async)?.length > 0">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Role</th>
        <th>Created</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <app-user-table-row 
        *ngFor="let user of (filteredUsers$ | async)"
        [user]="user"
        (edit)="onEdit($event)"
        (delete)="onDelete($event)">
      </app-user-table-row>
    </tbody>
  </table>
</div>